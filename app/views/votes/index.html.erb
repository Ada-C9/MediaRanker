
<h1 class='homepage'>OMFG IT'S MEDIA-RANKER!</h1>

<main class="row">
  <section class="row spotlight">
    <div>
      <% @spotlight_work = Work.get_top_work_with_tally[0] %>
      <% top_tally = Work.get_top_work_with_tally[1] %>
      <h3><span class="media-spotlight-header">Media Spotlight </span><%= link_to "#{@spotlight_work.title}", work_path(@spotlight_work.id) %><%= " by #{@spotlight_work.creator}" %></h3>
      <p><%= top_tally %> votes - <%= @spotlight_work.description %></p>
    </div>
  </section>
</main>

<hr class="root-hr" />

<section class="top-ten-container">
  <section class="top-ten">
    <h3>Top Albums</h3>
    <% @albums = Work.where(category: "album") %>
    <% @top_albums_n_tallies = @albums.get_top_ten_works_with_tallies %>
    <ul>
      <% @top_albums_n_tallies.each do |tallied| %>
        <% t_work = tallied[0] %>
        <% tally = tallied[1] %>
        <li>
          <h4><%= link_to t_work.title, work_path(t_work.id) %> by <%= t_work.creator %></h4>
          <p><%= tally %> votes</p>
        </li>
      <% end %>
    </ul>
  </section>
  <section class="top-ten">
    <h3>Top Books</h3>
    <% @books = Work.where(category: "book") %>
    <% @top_books_n_tallies = @books.get_top_ten_works_with_tallies %>
    <ul>
      <% @top_books_n_tallies.each do |tallied| %>
        <% t_work = tallied[0] %>
        <% tally = tallied[1] %>
        <li>
          <h4><%= link_to t_work.title, work_path(t_work.id) %> by <%= t_work.creator %></h4>
          <p><%= tally %> votes</p>
        </li>
      <% end %>
    </ul>
  </section>
  <section class="top-ten">
    <h3>Top Movies</h3>
    <% @movies = Work.where(category: "movie") %>
    <% @top_movies_n_tallies = @movies.get_top_ten_works_with_tallies %>
    <ul>
      <% @top_movies_n_tallies.each do |tallied| %>
        <% t_work = tallied[0] %>
        <% tally = tallied[1] %>
        <li>
          <h4><%= link_to t_work.title, work_path(t_work.id) %> by <%= t_work.creator %></h4>
          <p><%= tally %> votes</p>
        </li>
      <% end %>
    </ul>
  </section>
</section>
