<h3>List of Works</h3>

<main>
  <section class="albums">
    <h5><strong>Albums</strong></h5>
    <table>
      <tr>
        <th>
          Votes
        </th>
        <th>
          Title
        </th>
        <th>
          Created By
        </th>
        <th>
          Published
        </th>
        <th>
          Upvote
        </th>
      </tr>
      <% @works.where(category: "album").each do |album| %>
      <tr>
        <td>
          <%= votes = Vote.where(work_id: album.id).all.count %>
        </td>
        <td>
          <%= link_to album.title, work_path(album.id) %>
        </td>
        <td>
          <%= album.creator %>
        </td>
        <td>
          <%= album.publication_year %>
        </td>
        <td>
          <% votes = Vote.where("user_id = ? AND work_id = ?", @user.id, album.id) %>
          <% if votes.count > 0 %>
          <span class="button orange">Upvoted</span>
          <% else %>
          <%= link_to "Upvote", work_votes_path(album.id), method: :post, :class => "button" %>
          <% end %>
        </td>
      </tr>
      <% end %>
    </table>
  </section>
  <section class="books">
    <h5><strong>Books</strong></h5>
    <table>
      <tr>
        <th>
          Votes
        </th>
        <th>
          Title
        </th>
        <th>
          Created By
        </th>
        <th>
          Published
        </th>
        <th>
          Upvote
        </th>
      </tr>
      <% @works.where(category: "book").each do |book| %>
      <tr>
        <td>
          <%= votes = Vote.where(work_id: book.id).all.count %>
        </td>
        <td>
          <%= link_to book.title, work_path(book.id) %>
        </td>
        <td>
          <%= book.creator %>
        </td>
        <td>
          <%= book.publication_year %>
        </td>
        <td>
          <% votes = Vote.where("user_id = ? AND work_id = ?", @user.id, book.id) %>
          <% if votes.count > 0 %>
          <span class="button orange">Upvoted</span>
          <% else %>
          <%= link_to "Upvote", work_votes_path(book.id), method: :post, :class => "button" %>
          <% end %>
        </td>
      </tr>
      <% end %>
    </table>
  </section>
  <section class="movies">
    <h5><strong>Movies</strong></h5>
    <table>
      <tr>
        <th>
          Votes
        </th>
        <th>
          Title
        </th>
        <th>
          Created By
        </th>
        <th>
          Published
        </th>
        <th>
          Upvote
        </th>
      </tr>
      <% @works.where(category: "movie").each do |movie| %>
      <tr>
        <td>
          <%= votes = Vote.where(work_id: movie.id).all.count %>
        </td>
        <td>
          <%= link_to movie.title, work_path(movie.id) %>
        </td>
        <td>
          <%= movie.creator %>
        </td>
        <td>
          <%= movie.publication_year %>
        </td>
        <td>
          <% votes = Vote.where("user_id = ? AND work_id = ?", @user.id, movie.id) %>
          <% if votes.count > 0 %>
          <span class="button orange">Upvoted</span>
          <% else %>
          <%= link_to "Upvote", work_votes_path(movie.id), method: :post, :class => "button" %>
          <% end %>
        </td>
      </tr>
      <% end %>
    </table>
  </section>
</main>

<footer>
  <nav>
    <ul>
      <li>
        <%= link_to "View top media", root_path, :class => "button" %>
      </li>
      <li>
        <%= link_to "Add a new work", new_work_path, :class => "button" %>
      </li>
    </ul>
  </nav>
</footer>
