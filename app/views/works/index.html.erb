
<main class="row">
  <h3>List of works</h3>

<section class="media-table">
  <h4>Albums</h4>
  <table>
    <thead>
      <tr>
        <th width=80>Votes</th>
        <th>Title</th>
        <th>Created By</th>
        <th width=100>Published</th>
        <th width=100>Upvote</th>
      </tr>
    </thead>
    <tbody>
      <% @sorted_albums = Work.where(category: "album").works_ordered_by_popularity %>
      <% @sorted_albums.each do |work| %>
      <tr>
        <td><%= work.report_vote_tally(work.id) %></td>
        <td><%= link_to work.title, work_path(work[:id]) %></td>
        <td><%= work.creator %></td>
        <td><%= work.year_released %></td>
        <td><%= button_to "Upvote", work_votes_path(work[:id]), method: :post, class: 'button' %></td>
      </tr>
      <% end%>
    </tbody>
  </table>
</section>

<section class="media-table">
  <h4>Books</h4>
  <table>
    <thead>
      <tr>
        <th width=80>Votes</th>
        <th>Title</th>
        <th>Created By</th>
        <th width=100>Published</th>
        <th width=100>Upvote</th>
      </tr>
    </thead>
    <tbody>
      <% @sorted_books = Work.where(category: "book").works_ordered_by_popularity %>
      <% @sorted_books.each do |work| %>
      <tr>
        <td><%= work.report_vote_tally(work.id) %></td>
        <td><%= link_to work.title, work_path(work[:id]) %></td>
        <td><%= work.creator %></td>
        <td><%= work.year_released %></td>
        <td><%= button_to "Upvote", work_votes_path(work[:id]), method: :post, class: 'button' %></td>
      </tr>
      <% end%>
    </tbody>
  </table>
</section>


<section class="media-table">
  <h4>Movies</h4>
  <table>
    <thead>
      <tr>
        <th width=80>Votes</th>
        <th>Title</th>
        <th>Created By</th>
        <th width=100>Published</th>
        <th width=100>Upvote</th>
      </tr>
    </thead>
    <tbody>
      <% @sorted_movies = Work.where(category: "movie").works_ordered_by_popularity %>
      <% @sorted_movies.each do |work| %>
      <tr>
        <td><%= work.report_vote_tally(work.id) %></td>
        <td><%= link_to work.title, work_path(work[:id]) %></td>
        <td><%= work.creator %></td>
        <td><%= work.year_released %></td>
        <td><%= button_to "Upvote", work_votes_path(work[:id]), method: :post, class: 'button' %></td>
      </tr>
      <% end%>
    </tbody>
  </table>
</section>


<%= link_to "View Top Media", root_path, class: 'button' %>
<%= link_to "Add a new work", new_work_path, class: 'button' %>

</main>
